<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Paycheck Calculator</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 1000px; 
            margin: 0 auto; 
            padding: 20px; 
            line-height: 1.6; 
        }
        h1, h2, h3 { 
            color: #333; 
        }
        .page { 
            display: none; 
        }
        .page.active { 
            display: block; 
        }
        .form-group { 
            margin-bottom: 20px; 
        }
        label { 
            display: block; 
            margin-bottom: 5px; 
            font-weight: bold; 
        }
        input[type="number"], select { 
            width: 100%; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        button { 
            padding: 10px 15px; 
            background-color: #007bff; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            margin-right: 10px; 
        }
        button:hover { 
            background-color: #0056b3; 
        }
        .explanation { 
            background-color: #f8f8f8; 
            border-left: 4px solid #007bff; 
            padding: 10px; 
            margin-bottom: 20px; 
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px; 
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 12px; 
            text-align: left; 
        }
        th { 
            background-color: #f2f2f2; 
        }
        .header { 
            text-align: left; 
            margin-bottom: 20px; 
        }
        .logo { 
            max-width: 200px; 
            height: auto; 
            margin-bottom: 10px; 
        }
        .breakdown { 
            display: none; 
            margin-top: 10px; 
        }
        .breakdown.active { 
            display: block; 
        }
        .toggle-breakdown { 
            background: none; 
            border: none; 
            color: #007bff; 
            cursor: pointer; 
            padding: 0; 
        }
        .toggle-breakdown:hover { 
            text-decoration: underline; 
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="finmango.png" alt="FinMango Logo" class="logo">
        <h1>Global Paycheck Calculator</h1>
    </div>

    <div id="introPage" class="page active">
        <h2>Welcome to Your Comprehensive Global Paycheck Calculator</h2>
        <div class="explanation">
            <p>This calculator, by <a href="https://finmango.org" target="_blank">FinMango</a>, helps you evaluate your financial situation across different cities worldwide. It considers factors such as:</p>
            <ul>
                <li>Your annual salary</li>
                <li>Federal, state, and local taxes (for U.S. cities)</li>
                <li>Estimated tax rates for international cities</li>
                <li>Cost of living components</li>
                <li>Currency conversion for international comparisons</li>
            </ul>
            <p>Compare up to three cities to help make informed decisions about where to live and work globally.</p>
        </div>
        <button onclick="showPage('locationPage')">Let's Get Started</button>
    </div>
    
    <div id="locationPage" class="page">
        <h2>Select Cities to Compare</h2>
        <div class="explanation">
            <p>Choose up to three cities you'd like to compare. You can mix U.S. and international cities.</p>
        </div>
        <div class="form-group">
            <label for="location1">City 1:</label>
            <select id="location1" required onchange="updateCurrencyForLocation(1)"></select>
        </div>
        <div class="form-group">
            <label for="location2">City 2 (optional):</label>
            <select id="location2" onchange="updateCurrencyForLocation(2)"></select>
        </div>
        <div class="form-group">
            <label for="location3">City 3 (optional):</label>
            <select id="location3" onchange="updateCurrencyForLocation(3)"></select>
        </div>
        <button onclick="showPage('introPage')">Previous</button>
        <button onclick="showPage('salaryPage')">Next</button>
    </div>

    <div id="salaryPage" class="page">
        <h2>Enter Your Salary Information</h2>
        <div class="explanation">
            <p>Provide your annual salary in USD. This information will be used to calculate your take-home pay after taxes and compare it with the cost of living in each selected city.</p>
        </div>
        <div class="form-group">
            <label for="salary">Annual Salary (USD):</label>
            <input type="number" id="salary" required>
        </div>
        <button onclick="showPage('locationPage')">Previous</button>
        <button onclick="calculateResults()">Calculate Results</button>
    </div>

    <div id="resultsPage" class="page">
        <h2>Your Global Paycheck and Cost of Living Comparison</h2>
        <div class="explanation">
            <p>Below is a summary of your financial situation in each selected city. This includes your estimated take-home pay and annual expenses. Click "Show Breakdown" to see detailed calculations.</p>
        </div>
        <div id="resultsContainer">
            <!-- Results will be inserted here by JavaScript -->
        </div>
        <button onclick="showPage('locationPage')">Start Over</button>
    </div>

    <script>
    // Updated data for cities, including international options
    const locations = [
        // U.S. Cities
        { name: "New York, NY", country: "USA", stateTax: 0.0685, localTax: 0.03876, costIndex: 1.8, currency: "USD" },
        { name: "Los Angeles, CA", country: "USA", stateTax: 0.0930, localTax: 0, costIndex: 1.5, currency: "USD" },
        { name: "Chicago, IL", country: "USA", stateTax: 0.0495, localTax: 0.0925, costIndex: 1.2, currency: "USD" },
        { name: "Houston, TX", country: "USA", stateTax: 0, localTax: 0, costIndex: 0.95, currency: "USD" },
        { name: "Phoenix, AZ", country: "USA", stateTax: 0.0459, localTax: 0, costIndex: 1.05, currency: "USD" },
        { name: "Philadelphia, PA", country: "USA", stateTax: 0.0307, localTax: 0.038907, costIndex: 1.15, currency: "USD" },
        { name: "Boston, MA", country: "USA", stateTax: 0.05, localTax: 0, costIndex: 1.5, currency: "USD" },
        { name: "Miami, FL", country: "USA", stateTax: 0, localTax: 0, costIndex: 1.2, currency: "USD" },
        { name: "Atlanta, GA", country: "USA", stateTax: 0.0575, localTax: 0, costIndex: 1.0, currency: "USD" },
        { name: "Cleveland, OH", country: "USA", stateTax: 0.0399, localTax: 0.02, costIndex: 0.9, currency: "USD" },
        { name: "Cincinnati, OH", country: "USA", stateTax: 0.0399, localTax: 0.021, costIndex: 0.9, currency: "USD" },
        { name: "Columbus, OH", country: "USA", stateTax: 0.0399, localTax: 0.025, costIndex: 0.95, currency: "USD" },
        { name: "Nashville, TN", country: "USA", stateTax: 0, localTax: 0, costIndex: 1.05, currency: "USD" },
        { name: "Austin, TX", country: "USA", stateTax: 0, localTax: 0, costIndex: 1.1, currency: "USD" },
        { name: "Seattle, WA", country: "USA", stateTax: 0, localTax: 0, costIndex: 1.5, currency: "USD" },
        { name: "San Francisco, CA", country: "USA", stateTax: 0.0930, localTax: 0, costIndex: 1.9, currency: "USD" },
        { name: "Minneapolis, MN", country: "USA", stateTax: 0.0785, localTax: 0, costIndex: 1.05, currency: "USD" },
        { name: "Baltimore, MD", country: "USA", stateTax: 0.0575, localTax: 0.032, costIndex: 1.1, currency: "USD" },
        { name: "Washington, D.C.", country: "USA", stateTax: 0.0895, localTax: 0, costIndex: 1.6, currency: "USD" },
        
        // International Cities (example data, adjust as needed)
        { name: "London", country: "UK", taxRate: 0.30, costIndex: 1.7, currency: "GBP" },
        { name: "Tokyo", country: "Japan", taxRate: 0.25, costIndex: 1.6, currency: "JPY" },
        { name: "Paris", country: "France", taxRate: 0.35, costIndex: 1.5, currency: "EUR" },
        { name: "Sydney", country: "Australia", taxRate: 0.32, costIndex: 1.4, currency: "AUD" },
        { name: "Toronto", country: "Canada", taxRate: 0.28, costIndex: 1.3, currency: "CAD" },
        { name: "Berlin", country: "Germany", taxRate: 0.33, costIndex: 1.2, currency: "EUR" },
        { name: "Singapore", country: "Singapore", taxRate: 0.20, costIndex: 1.5, currency: "SGD" },
        { name: "Dubai", country: "UAE", taxRate: 0.05, costIndex: 1.3, currency: "AED" },
        { name: "Mumbai", country: "India", taxRate: 0.30, costIndex: 0.8, currency: "INR" },
        { name: "SÃ£o Paulo", country: "Brazil", taxRate: 0.27, costIndex: 0.9, currency: "BRL" }
    ];

    // Exchange rates (example data, you should use up-to-date rates)
    const exchangeRates = {
        USD: 1,
        GBP: 0.72,
        JPY: 110.59,
        EUR: 0.84,
        AUD: 1.33,
        CAD: 1.25,
        SGD: 1.34,
        AED: 3.67,
        INR: 74.24,
        BRL: 5.24
    };

    // Populate location dropdowns
    function populateLocations() {
        const selects = [document.getElementById('location1'), document.getElementById('location2'), document.getElementById('location3')];
        selects.forEach(select => {
            select.innerHTML = '<option value="">Select a city</option>';
            
            // Group U.S. cities
            const usGroup = document.createElement('optgroup');
            usGroup.label = 'United States';
            locations.filter(loc => loc.country === "USA").forEach(location => {
                const option = document.createElement('option');
                option.value = location.name;
                option.textContent = location.name;
                usGroup.appendChild(option);
            });
            select.appendChild(usGroup);
            
            // Group International cities
            const intGroup = document.createElement('optgroup');
            intGroup.label = 'International';
            locations.filter(loc => loc.country !== "USA").forEach(location => {
                const option = document.createElement('option');
                option.value = location.name;
                option.textContent = `${location.name}, ${location.country}`;
                intGroup.appendChild(option);
            });
            select.appendChild(intGroup);
        });
    }

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
    }

    function toggleBreakdown(id) {
        const breakdown = document.getElementById(id);
        breakdown.classList.toggle('active');
    }

    function updateCurrencyForLocation(locationNumber) {
        const locationSelect = document.getElementById(`location${locationNumber}`);
        const selectedLocation = locations.find(loc => loc.name === locationSelect.value);
        if (selectedLocation) {
            console.log(`Selected currency for location ${locationNumber}: ${selectedLocation.currency}`);
        }
    }

    // Initialize the calculator
    populateLocations();

    // ... (The rest of the JavaScript code will follow in subsequent parts)
    </script>
</body>
</html>
// Calculate federal tax for U.S. cities
    function calculateFederalTax(salary) {
        // 2023 tax brackets (simplified)
        if (salary <= 11000) return salary * 0.10;
        if (salary <= 44725) return 1100 + (salary - 11000) * 0.12;
        if (salary <= 95375) return 5147 + (salary - 44725) * 0.22;
        if (salary <= 182100) return 16290 + (salary - 95375) * 0.24;
        if (salary <= 231250) return 37104 + (salary - 182100) * 0.32;
        if (salary <= 578125) return 52832 + (salary - 231250) * 0.35;
        return 174238.25 + (salary - 578125) * 0.37;
    }

    // Calculate take-home pay for U.S. cities
    function calculateUSTakeHomePay(salary, location) {
        const federalTax = calculateFederalTax(salary);
        const stateTax = salary * location.stateTax;
        const localTax = salary * location.localTax;
        const socialSecurity = Math.min(salary * 0.062, 9932.40); // 2023 cap
        const medicare = salary * 0.0145;
        const totalTax = federalTax + stateTax + localTax + socialSecurity + medicare;
        return salary - totalTax;
    }

    // Calculate take-home pay for international cities
    function calculateInternationalTakeHomePay(salary, location) {
        const taxRate = location.taxRate;
        const totalTax = salary * taxRate;
        return salary - totalTax;
    }

    // Convert USD to local currency
    function convertToLocalCurrency(amountUSD, currency) {
        return amountUSD / exchangeRates[currency];
    }

    // Format currency for display
    function formatCurrency(amount, currency) {
        const formatter = new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: currency,
            minimumFractionDigits: 0,
            maximumFractionDigits: 0,
        });
        return formatter.format(amount);
    }

    // Calculate results for all selected locations
    function calculateResults() {
        const salary = parseFloat(document.getElementById('salary').value);
        const selectedLocations = [
            document.getElementById('location1').value,
            document.getElementById('location2').value,
            document.getElementById('location3').value
        ].filter(Boolean);

        const results = selectedLocations.map(locationName => {
            const location = locations.find(loc => loc.name === locationName);
            let takehomePay, taxPaid;

            if (location.country === "USA") {
                takehomePay = calculateUSTakeHomePay(salary, location);
                taxPaid = salary - takehomePay;
            } else {
                takehomePay = calculateInternationalTakeHomePay(salary, location);
                taxPaid = salary - takehomePay;
            }

            const localCurrencyTakeHome = convertToLocalCurrency(takehomePay, location.currency);
            const localCurrencyTaxPaid = convertToLocalCurrency(taxPaid, location.currency);

            // Estimate annual expenses based on cost of living index
            const baseExpenses = 40000; // Baseline annual expenses for a cost index of 1.0
            const annualExpensesUSD = baseExpenses * location.costIndex;
            const annualExpensesLocal = convertToLocalCurrency(annualExpensesUSD, location.currency);

            return {
                location: locationName,
                country: location.country,
                currency: location.currency,
                grossPayUSD: salary,
                grossPayLocal: convertToLocalCurrency(salary, location.currency),
                takehomePayUSD: takehomePay,
                takehomePayLocal: localCurrencyTakeHome,
                taxPaidUSD: taxPaid,
                taxPaidLocal: localCurrencyTaxPaid,
                annualExpensesUSD: annualExpensesUSD,
                annualExpensesLocal: annualExpensesLocal,
                remainingMoneyUSD: takehomePay - annualExpensesUSD,
                remainingMoneyLocal: localCurrencyTakeHome - annualExpensesLocal,
                costIndex: location.costIndex
            };
        });

        displayResults(results);
        showPage('resultsPage');
    }

    // Display calculated results
    function displayResults(results) {
        const container = document.getElementById('resultsContainer');
        container.innerHTML = '';

        results.forEach((result, index) => {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result-section';
            resultDiv.innerHTML = `
                <h3>${result.location}, ${result.country}</h3>
                <p>Gross Pay: ${formatCurrency(result.grossPayUSD, 'USD')} (${formatCurrency(result.grossPayLocal, result.currency)})</p>
                <p>Take-Home Pay: ${formatCurrency(result.takehomePayUSD, 'USD')} (${formatCurrency(result.takehomePayLocal, result.currency)})</p>
                <p>Annual Expenses: ${formatCurrency(result.annualExpensesUSD, 'USD')} (${formatCurrency(result.annualExpensesLocal, result.currency)})</p>
                <p>Remaining Money: <span style="color: ${result.remainingMoneyUSD >= 0 ? 'green' : 'red'}">${formatCurrency(result.remainingMoneyUSD, 'USD')} (${formatCurrency(result.remainingMoneyLocal, result.currency)})</span></p>
                <button class="toggle-breakdown" onclick="toggleBreakdown('breakdown-${index}')">Show Breakdown</button>
                <div id="breakdown-${index}" class="breakdown">
                    <h4>Detailed Breakdown</h4>
                    <table>
                        <tr><td>Gross Pay:</td><td>${formatCurrency(result.grossPayUSD, 'USD')} (${formatCurrency(result.grossPayLocal, result.currency)})</td></tr>
                        <tr><td>Tax Paid:</td><td>${formatCurrency(result.taxPaidUSD, 'USD')} (${formatCurrency(result.taxPaidLocal, result.currency)})</td></tr>
                        <tr><td>Take-Home Pay:</td><td>${formatCurrency(result.takehomePayUSD, 'USD')} (${formatCurrency(result.takehomePayLocal, result.currency)})</td></tr>
                        <tr><td>Cost of Living Index:</td><td>${result.costIndex.toFixed(2)}</td></tr>
                        <tr><td>Estimated Annual Expenses:</td><td>${formatCurrency(result.annualExpensesUSD, 'USD')} (${formatCurrency(result.annualExpensesLocal, result.currency)})</td></tr>
                        <tr><td>Remaining Money:</td><td>${formatCurrency(result.remainingMoneyUSD, 'USD')} (${formatCurrency(result.remainingMoneyLocal, result.currency)})</td></tr>
                    </table>
                </div>
            `;
            container.appendChild(resultDiv);
        });
    }

    // ... (The rest of the JavaScript code will follow in the final part)
// Utility function to validate input
    function validateInput() {
        const salary = document.getElementById('salary').value;
        const location1 = document.getElementById('location1').value;
        
        if (!salary || salary <= 0) {
            alert("Please enter a valid salary.");
            return false;
        }
        
        if (!location1) {
            alert("Please select at least one location.");
            return false;
        }
        
        return true;
    }

    // Event listener for the calculate button
    document.querySelector('button[onclick="calculateResults()"]').addEventListener('click', function(e) {
        e.preventDefault();
        if (validateInput()) {
            calculateResults();
        }
    });

    // Event listeners for navigation buttons
    document.querySelectorAll('button[onclick^="showPage"]').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const pageId = this.getAttribute('onclick').match(/'(\w+)'/)[1];
            showPage(pageId);
        });
    });

    // Function to reset the calculator
    function resetCalculator() {
        document.getElementById('salary').value = '';
        document.getElementById('location1').value = '';
        document.getElementById('location2').value = '';
        document.getElementById('location3').value = '';
        document.getElementById('resultsContainer').innerHTML = '';
        showPage('introPage');
    }

    // Add event listener for reset functionality
    document.querySelector('button[onclick="showPage(\'locationPage\')"]').addEventListener('click', resetCalculator);

    // Function to handle window resize and adjust layout if necessary
    function handleResize() {
        const width = window.innerWidth;
        const resultsContainer = document.getElementById('resultsContainer');
        if (width < 768) {
            resultsContainer.style.flexDirection = 'column';
        } else {
            resultsContainer.style.flexDirection = 'row';
        }
    }

    // Add event listener for window resize
    window.addEventListener('resize', handleResize);

    // Call handleResize on initial load
    handleResize();

    // Function to save results (placeholder for future functionality)
    function saveResults() {
        console.log('Results saved!');
        // Implement saving functionality here (e.g., local storage, server-side storage)
        alert('Results have been saved. (This is a placeholder message)');
    }

    // Add save button to results page
    const saveButton = document.createElement('button');
    saveButton.textContent = 'Save Results';
    saveButton.onclick = saveResults;
    document.getElementById('resultsPage').appendChild(saveButton);

    // Function to load and display exchange rates
    function loadExchangeRates() {
        // In a real-world scenario, you would fetch this data from an API
        const ratesDisplay = document.createElement('div');
        ratesDisplay.innerHTML = '<h3>Current Exchange Rates (USD)</h3>';
        for (const [currency, rate] of Object.entries(exchangeRates)) {
            if (currency !== 'USD') {
                ratesDisplay.innerHTML += `<p>${currency}: ${rate.toFixed(2)}</p>`;
            }
        }
        document.body.appendChild(ratesDisplay);
    }

    // Call loadExchangeRates on initial load
    loadExchangeRates();

    // Initialize the calculator
    document.addEventListener('DOMContentLoaded', function() {
        populateLocations();
        showPage('introPage');
    });

    console.log('Global Paycheck Calculator initialized successfully!');
